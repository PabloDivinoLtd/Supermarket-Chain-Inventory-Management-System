DROP DATABASE DBMSMiniPro;

CREATE DATABASE DBMSMiniPro;

USE DBMSMiniPro;
CREATE TABLE COMPANY(CID INT PRIMARY KEY,CNAME VARCHAR(20) NOT NULL);

CREATE TABLE BRANCHES(
  BID INT NOT NULL, 
  LOC VARCHAR(20) NOT NULL, 
  CID INT NOT NULL, 
  PRIMARY KEY(BID,CID), 
  FOREIGN KEY(CID) REFERENCES COMPANY(CID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE DEPARTMENT( 
  DID INT NOT NULL, 
  BID INT NOT NULL, 
  CID INT NOT NULL, 
  DNAME VARCHAR(20) NOT NULL, 
  PRIMARY KEY(DID, BID, CID), 
  FOREIGN KEY(BID,CID) REFERENCES BRANCHES(BID,CID) ON UPDATE CASCADE ON DELETE CASCADE);

CREATE TABLE PRODUCT(
  PID INT NOT NULL, 
  DID INT NOT NULL,
  BID INT NOT NULL,
  CID INT NOT NULL,  
  PRODUCT_NAME VARCHAR(30) NOT NULL, 
  EXP_DATE DATE, 
  QUANTITY INT NOT NULL, 
  MIN_QTY INT NOT NULL, 
  PRICE_PER_UNIT FLOAT NOT NULL, 
  PRIMARY KEY(PID,BID,DID), 
  FOREIGN KEY(DID,BID,CID) REFERENCES DEPARTMENT (DID,BID,CID) ON UPDATE CASCADE ON DELETE CASCADE );
  
CREATE TABLE PRODUCT_SOLD(
  PID INT NOT NULL, 
  DID INT NOT NULL, 
  CID INT NOT NULL,
  BID INT NOT NULL,       
  QUANTITY INT NOT NULL,  
  TOTAL_PRICE FLOAT NOT NULL,
  QUANTITY_EXPIRED INT,
  TOTAL_PRICE_EXPIRED FLOAT, 
  PRIMARY KEY(PID,BID,DID,CID),  
  FOREIGN KEY(DID,BID,CID) REFERENCES DEPARTMENT (DID,BID,CID) ON UPDATE CASCADE ON DELETE CASCADE );


INSERT INTO COMPANY VALUES (1, 'BigBazar');
INSERT INTO COMPANY VALUES (2, 'Spar');
INSERT INTO COMPANY VALUES (3, 'More'); 	

INSERT INTO BRANCHES VALUES (1, 'Kormangala', 1);
INSERT INTO BRANCHES VALUES (2, 'Whitefield', 1);
INSERT INTO BRANCHES VALUES (3, 'Shantinagar', 1);
INSERT INTO BRANCHES VALUES (1, 'Diary Circle', 2);
INSERT INTO BRANCHES VALUES (2, 'Sarjapur', 2);
INSERT INTO BRANCHES VALUES (1, 'Madiwala', 3);
INSERT INTO BRANCHES VALUES (2, 'Marathahalli', 3);
INSERT INTO BRANCHES VALUES (3, 'KR Puram', 3);

INSERT INTO DEPARTMENT VALUES (1,1,1,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,1,1,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (3,1,1,'CLOTHING');
INSERT INTO DEPARTMENT VALUES (4,1,1,'HOME');
INSERT INTO DEPARTMENT VALUES (5,1,1,'ELECTRICAL&ELECTRONICS');

INSERT INTO DEPARTMENT VALUES (1,2,1,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,2,1,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (3,2,1,'CLOTHING');
INSERT INTO DEPARTMENT VALUES (4,2,1,'HOME');

INSERT INTO DEPARTMENT VALUES (1,3,1,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,3,1,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (3,3,1,'CLOTHING');

INSERT INTO DEPARTMENT VALUES (1,1,2,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,1,2,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (3,1,2,'CLOTHING');
INSERT INTO DEPARTMENT VALUES (4,1,2,'HOME');
INSERT INTO DEPARTMENT VALUES (5,1,2,'ELECTRICAL&ELECTRONICS');

INSERT INTO DEPARTMENT VALUES (1,2,2,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,2,2,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (4,2,2,'HOME');
INSERT INTO DEPARTMENT VALUES (5,2,2,'ELECTRICAL&ELECTRONICS');

INSERT INTO DEPARTMENT VALUES (1,1,3,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,1,3,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (3,1,3,'CLOTHING');
INSERT INTO DEPARTMENT VALUES (4,1,3,'HOME');
INSERT INTO DEPARTMENT VALUES (5,1,3,'ELECTRICAL&ELECTRONICS');

INSERT INTO DEPARTMENT VALUES (1,2,3,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,2,3,'HEALTH AND NUTRITION');
INSERT INTO DEPARTMENT VALUES (4,2,3,'HOME');

INSERT INTO DEPARTMENT VALUES (1,3,3,'FOOD AND BEVERAGES');
INSERT INTO DEPARTMENT VALUES (2,3,3,'HEALTH AND NUTRITION');

INSERT INTO PRODUCT VALUES(1,4,1,1,'SCRUBBER',"2017-12-10",150,20,20);
INSERT INTO PRODUCT VALUES(2,4,1,1,'COTTON MOP',"2018-1-10",50,10,200);
INSERT INTO PRODUCT VALUES(3,4,1,1,'SOUP BOWL',"2018-12-10",250,30,120);
INSERT INTO PRODUCT VALUES(4,4,1,1,'CROCKERY PLATE',"2018-12-10",250,30,220);
INSERT INTO PRODUCT VALUES(5,4,1,1,'PLASTIC TRAY',"2018-12-10",50,10,20);
INSERT INTO PRODUCT VALUES(1,1,1,1,'ENERGY DRINK',"2018-1-1",250,50,70);
INSERT INTO PRODUCT VALUES(2,1,1,1,'HEALTH DRINK',"2017-12-10",50,10,200);
INSERT INTO PRODUCT VALUES(3,1,1,1,'SOFT DRINK',"2017-12-31",500,70,50);
INSERT INTO PRODUCT VALUES(4,1,1,1,'TEA & COFFEE',"2018-3-10",500,70,120);
INSERT INTO PRODUCT VALUES(5,1,1,1,'MILK & DIARY',"2017-12-1",200,40,20);
INSERT INTO PRODUCT VALUES(6,1,1,1,'BREAD',"2017-12-1",75,10,30);
INSERT INTO PRODUCT VALUES(1,3,1,1,'JEANS (M)',NULL,100,50,1300);
INSERT INTO PRODUCT VALUES(2,3,1,1,'JEANS (F)',NULL,75,40,1300);
INSERT INTO PRODUCT VALUES(3,3,1,1,'T SHIRTS (M)',NULL,500,200,600);
INSERT INTO PRODUCT VALUES(4,3,1,1,'T SHIRTS(F)',NULL,700,250,500);
INSERT INTO PRODUCT VALUES(5,3,1,1,'BELTS',NULL,100,30,400);

INSERT INTO PRODUCT VALUES(1,2,1,1,'SANITIZER',"2018-11-1",70,20,60);
INSERT INTO PRODUCT VALUES(2,2,1,1,'LIP CARE',"2018-01-1",50,10,70);
INSERT INTO PRODUCT VALUES(3,2,1,1,'CALCIUM TABS',"2018-2-1",70,20,200);
INSERT INTO PRODUCT VALUES(4,2,1,1,'INSECT KILLER',"2011-12-15",50,20,300);
